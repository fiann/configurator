"use strict";(function(){var k={id:"causata-transport",name:"Causata Transport Plugin",version:"0.4.2",vendor:"Causata Inc",type:"data-transport"},b=["page-view","product-view","authentication","checkout","site-search","nat-search-ref"],h="string",g="number",j="page-",n="product-",c="url",l="referrer",f=/^url|tzOffset|sW|sH|wW|wH|colors|plugins$/,d={server:null,account:null},a=[],m=false,o=function(t,s,r){if(/-source$/.test(s)){return;}var q=typeof r,p;if("string"===q||"number"===q){t.push({name:s,value:r});}else{if(jsHub.util.isArray(r)){for(p=0;p<r.length;p++){o(t,s,r[p]);}}}},i=function(){if(typeof d.server!=="string"){jsHub.trigger("plugin-error",{message:"Server hostname not specified",source:k.id});return;}var s,t,q,v,u,r;var p={sender:k.name+" v"+k.version,event:[]};for(s=0;s<a.length;s++){t=a[s];q={timestamp:t.timestamp,eventType:t.type};if(typeof d.account==="string"){q.organization=d.account;}r=[];for(v in t.data){if(t.data.hasOwnProperty(v)){u=t.data[v];if(f.test(v)){p[v]=u;}else{if(v==="referrer"){if(u===""){u="(direct)";}p.referrer=u;}else{o(r,v,u);}}}}if(r.length>0){q.attributes=r;}p.event.push(jsHub.json.stringify(q));}a=[];var w=(("https:"===jsHub.safe("document").location.protocol)?"https://":"http://");jsHub.dispatchViaForm("POST",w+d.server,p);};jsHub.trigger("plugin-initialization-start",k);k.eventHandler=function e(r){if(r.type==="data-capture-start"){m=true;}if(r.type==="data-capture-complete"){m=false;i();}var q=false;if(""+r.data["custom-event"]==="true"){q="custom";}else{for(var p=0;p<b.length;p++){if(b[p]===r.type){q="standard";break;}}}if(q){a.push(r);if(!m){i();}}};k.configure=function(p,q){d[p]=""+q;};jsHub.bind("*",k);jsHub.trigger("plugin-initialization-complete",k);})();
"use strict";(function(){var h={id:"causata-transport",name:"Causata Transport Plugin",version:"0.4.4",vendor:"Causata Inc",type:"data-transport"},a="authentication,checkout,download,nat-search-ref,page-view,product-view,site-exit,site-search".split(","),f="string",e=/^url|tzOffset|sW|sH|wW|wH|colors|plugins$/,c={server:null,account:null},b=[],i=false,j=function(o,n,m){if(/-source$/.test(n)){return;}var l=typeof m,k;if(f===l||"number"===l){o.push({name:n,value:m});}else{if(jsHub.util.isArray(m)){for(k=0;k<m.length;k++){j(o,n,m[k]);}}}},g=function(){if(typeof c.server!==f){jsHub.trigger("plugin-error",{message:"Server hostname not specified",source:h.id});return;}var m,k,s,n,p,l;var o={sender:h.name+" v"+h.version,event:[]};for(m=0;m<b.length;m++){k=b[m];s={timestamp:k.timestamp,eventType:k.type};if(typeof c.account===f){s.organization=c.account;}l=[];for(n in k.data){if(k.data.hasOwnProperty(n)){p=k.data[n];if(e.test(n)){o[n]=p;}else{if(n==="referrer"){if(p===""){p="(direct)";}o.referrer=p;}else{j(l,n,p);}}}}if(l.length>0){s.attributes=l;}o.event.push(jsHub.json.stringify(s));}b=[];var r=(("https:"===jsHub.safe("document").location.protocol)?"https://":"http://"),q=c.server.split(/\s*,\s*/);for(m=0;m<q.length;m++){jsHub.dispatchViaForm("POST",r+q[m],o);}};jsHub.trigger("plugin-initialization-start",h);h.eventHandler=function d(m){if(m.type==="data-capture-start"){i=true;}if(m.type==="data-capture-complete"){i=false;g();}var l=false;if(""+m.data["custom-event"]==="true"){l="custom";}else{if(m.type.match(/^error-/)){l="standard";}else{for(var k=0;k<a.length;k++){if(a[k]===m.type){l="standard";break;}}}}if(l){b.push(m);if(!i){g();}}};h.configure=function(k,l){c[k]=""+l;};jsHub.bind("*",h);jsHub.trigger("plugin-initialization-complete",h);})();
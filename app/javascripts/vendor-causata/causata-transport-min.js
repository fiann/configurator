"use strict";(function(){var h={id:"causata-transport",name:"Causata Transport Plugin",version:"0.4.3",vendor:"Causata Inc",type:"data-transport"},a="authentication,checkout,download,nat-search-ref,page-view,product-view,site-exit,site-search".split(","),f="string",e=/^url|tzOffset|sW|sH|wW|wH|colors|plugins$/,c={server:null,account:null},b=[],i=false,j=function(o,n,m){if(/-source$/.test(n)){return;}var l=typeof m,k;if(f===l||"number"===l){o.push({name:n,value:m});}else{if(jsHub.util.isArray(m)){for(k=0;k<m.length;k++){j(o,n,m[k]);}}}},g=function(){if(typeof c.server!==f){jsHub.trigger("plugin-error",{message:"Server hostname not specified",source:h.id});return;}var n,o,l,q,p,m;var k={sender:h.name+" v"+h.version,event:[]};for(n=0;n<b.length;n++){o=b[n];l={timestamp:o.timestamp,eventType:o.type};if(typeof c.account===f){l.organization=c.account;}m=[];for(q in o.data){if(o.data.hasOwnProperty(q)){p=o.data[q];if(e.test(q)){k[q]=p;}else{if(q==="referrer"){if(p===""){p="(direct)";}k.referrer=p;}else{j(m,q,p);}}}}if(m.length>0){l.attributes=m;}k.event.push(jsHub.json.stringify(l));}b=[];var r=(("https:"===jsHub.safe("document").location.protocol)?"https://":"http://");jsHub.dispatchViaForm("POST",r+c.server,k);};jsHub.trigger("plugin-initialization-start",h);h.eventHandler=function d(m){if(m.type==="data-capture-start"){i=true;}if(m.type==="data-capture-complete"){i=false;g();}var l=false;if(""+m.data["custom-event"]==="true"){l="custom";}else{if(m.type.match(/^error-/)){l="standard";}else{for(var k=0;k<a.length;k++){if(a[k]===m.type){l="standard";break;}}}}if(l){b.push(m);if(!i){g();}}};h.configure=function(k,l){c[k]=""+l;};jsHub.bind("*",h);jsHub.trigger("plugin-initialization-complete",h);})();
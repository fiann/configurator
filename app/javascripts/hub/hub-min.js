"use strict";(function(){var c=window,b,a=function(){var j={},f=[],g={},k=function(l,m){this.token=l;this.callback=m;},e=function(l,n,m){this.type=l;this.timestamp=m||b.safe.getTimestamp();this.data=n;},i=function(){var l=function(o,q){o=o.split(",");for(var p=0;p<o.length;p++){if(q===b.util.trim(o[p])){return true;}}return false;},n=function(o,q){var p=b.util.trim(q.event_visibility);if(p===undefined||p===""||p==="*"){return true;}return l(p,o);},m=function(p,q){var o={};b.util.each(q,function(t,s){if(/_visibility$/.test(s)===false){var r=q[s+"_visibility"];if(typeof r!=="string"||r===""||r==="*"||l(r,p)){o[s]=t;}}});return o;};this.dispatch=function(p,u,t,s){var o,r,q;if(n(u.token,t)){r=m(u.token,t);o=new e(p,r,s);q=u.callback(o);if(q){b.util.merge(t,q);}}};},h=new i();this.bind=function(l,n,q){var p=j[l],o,m;if("undefined"===typeof p){p=[];}for(o=false,m=0;m<p.length;m++){if(p[m].token===n){p[m].callback=q;o=true;break;}}if(!o){p.push(new k(n,q));}j[l]=p;};this.trigger=function(s,q,t){q=q||{};var n=(j[s]||[]);var u,m,l=(j["*"]||[]),r,p;for(r=0;r<l.length;r++){m=l[r];u=false;for(p=0;p<n.length;p++){if(n[p].token===m.token){u=true;}}if(!u){n.push(m);}}for(var o=0;o<n.length;o++){h.dispatch(s,n[o],q,t);}if(s==="plugin-initialization-start"){f.push(q);if(g[q.id]){this.configure(q.id,g[q.id]);}}};this.getPluginInfo=function(){var p=[],l;for(l=0;l<f.length;l++){var m=f[l],o={};for(var n in m){if(typeof m[n]==="string"||typeof m[n]==="number"){o[n]=m[n];}}p.push(o);}return p;};this.configure=function(s,p){if(typeof s!=="string"){throw new Error("Invalid configuration key");}var o,t,q,u=s.split("."),m=typeof p;t=function(){var v,w=u.slice(1,u.length).join(".");for(v=0;v<f.length;v++){if(o===f[v].id&&typeof f[v].configure==="function"){f[v].configure(w,p);return;}}};o=u[0];q=u[u.length-1];for(var r=g,n=0;n<u.length-1;n++){r[u[n]]=r[u[n]]||{};r=r[u[n]];}if(m==="string"||m==="number"||m==="boolean"){r[q]=p;t();}else{if(p===null){delete r[q];t();}else{if(m==="object"){for(var l in p){if(p.hasOwnProperty(l)){this.configure(s+"."+l,p[l]);}}}else{return r[q];}}}};};b=c.jsHub=new a();b.safe=function(f){var e;if("document"===f){e={location:{hash:document.location.hash,host:document.location.host,hostname:document.location.hostname,href:document.location.href,pathname:document.location.pathname,port:document.location.port,protocol:document.location.protocol,search:document.location.search},title:document.title,referrer:(document.referrer===null)?"":document.referrer,cookies:document.cookies,domain:"Unsafe property"};}else{e={};}return e;};b.safe.getTimestamp=function(){return new Date().getTime();};var d=function(){var e=this;e.trim=function(f){if(typeof f==="string"){f=f.replace(/(&nbsp;|\s)+/g," ").replace(/(^\s+)|(\s+$)/g,"");}return f;};e.isArray=function(f){return Object.prototype.toString.call(f)==="[object Array]";};e.each=function(g,k){if(e.isArray(g)){for(var j=0,f=g.length;j<f;j++){k.call(b,g[j],j);}}else{if(typeof g==="object"){for(var h in g){if(g.hasOwnProperty(h)){k.call(b,g[h],h);}}}}return g;};e.merge=function(f,h){f=f||{};h=h||{};for(var g in h){if(h.hasOwnProperty(g)){f[g]=h[g];}}return f;};};b.util=new d();})();